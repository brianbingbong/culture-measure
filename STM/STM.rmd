```{r}
library(tidyverse)
library(dplyr)
library(readr)
```

```{r}
myfiles = list.files(pattern="*.csv", full.names = FALSE)


myfiles2 <- lapply(myfiles, function(x) {
    t <- read.csv(x)
    mutate(t, document = gsub( ".csv", "", x ))
    }) %>%
  bind_rows


```

```{r}
library(stm)
processed <- textProcessor(myfiles2$review_text, metadata=myfiles2)
```
```{r}
out <- prepDocuments(processed$documents, processed$vocab, processed$meta)
docs <- out$documents
vocab <- out$vocab
meta <- out$meta

```

```{r}
vocab
```
```{r}
library(Rcpp)
First_STM <- stm(documents = out$documents, vocab = out$vocab, K = 6, data = out$meta, init.type = "Spectral", verbose = FALSE)
```

```{r}
plot(First_STM)
```